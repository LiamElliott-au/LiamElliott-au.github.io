<!DOCTYPE html>
<html lang="en-us">

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  
  <title>SignalR - Why? Because its easy | Liam Elliott</title>
  <meta name="viewport" content="width=device-width,minimum-scale=1">
  <meta name="generator" content="Hugo 0.76.3" />
  
  
  <META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">
  

  
  
  <link href="/dist/css/app.4bd986c7c826760f57a88dd57c7ecbaf.css" rel="stylesheet">
  

  

  
  

  

  

  <meta property="og:title" content="SignalR - Why? Because its easy" />
<meta property="og:description" content="SignalR has been around for a few years now (since 2013), offering real-time notifications to our .Net applications." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://drafts.liamelliott.me/blog/2018-08-21-signalr/" />
<meta property="article:published_time" content="2018-08-21T22:50:00+00:00" />
<meta property="article:modified_time" content="2018-08-21T22:50:00+00:00" />
<meta itemprop="name" content="SignalR - Why? Because its easy">
<meta itemprop="description" content="SignalR has been around for a few years now (since 2013), offering real-time notifications to our .Net applications.">
<meta itemprop="datePublished" content="2018-08-21T22:50:00+00:00" />
<meta itemprop="dateModified" content="2018-08-21T22:50:00+00:00" />
<meta itemprop="wordCount" content="1227">



<meta itemprop="keywords" content="angular,signalr,realtime,asp-net-core," />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="SignalR - Why? Because its easy"/>
<meta name="twitter:description" content="SignalR has been around for a few years now (since 2013), offering real-time notifications to our .Net applications."/>

  
</head>

<body
  class="ma0 avenir bg-near-white DEV">

  





<header class="cover bg-top vh-75" style="background-image: url('https://drafts.liamelliott.me/images/headers/carlos-alberto-gomez-iniguez-253158-unsplash.jpg');">
  <div class="pb3-m pb6-l">
    <nav class="pv1 ph3 ph4-ns shadow-5 position fixed top-0 w-100 bg-black-40 z-max" style="backdrop-filter: blur(5px);"
  role="navigation">
  <div class="flex-l justify-between items-center center">
    <div class="flex-l items-center">
      
 
      <ul class="pl0 mr3">
        <li class="list f6 f4-ns fw4 dib pr3">
          <a class="hover-white no-underline white-90" href="/" title="Home">
            Home
          </a>
        </li>
        
        <li class="list f6 f4-ns fw4 dib pr3">
          <a class="hover-white no-underline white-90" href="/about/" title="About page">
            About
          </a>
        </li>
        
        <li class="list f6 f4-ns fw4 dib pr3">
          <a class="hover-white no-underline white-90" href="/blog/" title="Blog page">
            Blog
          </a>
        </li>
        
        <li class="list f6 f4-ns fw4 dib pr3">
          <a class="hover-white no-underline white-90" href="/reading/" title="Reading page">
            Reading
          </a>
        </li>
        
        <li class="list f6 f4-ns fw4 dib pr3">
          <a class="hover-white no-underline white-90" href="/videos/" title="Videos page">
            Videos
          </a>
        </li>
        
      </ul>
      
    </div>
    <div class="flex-l items-center">
      




<a href="https://twitter.com/LiamElliott_au" target="_blank" class="link-transition twitter link dib z-999 pt3 pt0-l mr1" title="Twitter link" rel="noopener" aria-label="follow on Twitter——Opens in a new window">
  <svg height="32px"  style="enable-background:new 0 0 67 67;" version="1.1" viewBox="0 0 67 67" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167,22.283c-2.619,0.953-4.274,3.411-4.086,6.101  l0.063,1.038l-1.048-0.127c-3.813-0.487-7.145-2.139-9.974-4.915l-1.383-1.377l-0.356,1.017c-0.754,2.267-0.272,4.661,1.299,6.271  c0.838,0.89,0.649,1.017-0.796,0.487c-0.503-0.169-0.943-0.296-0.985-0.233c-0.146,0.149,0.356,2.076,0.754,2.839  c0.545,1.06,1.655,2.097,2.871,2.712l1.027,0.487l-1.215,0.021c-1.173,0-1.215,0.021-1.089,0.467  c0.419,1.377,2.074,2.839,3.918,3.475l1.299,0.444l-1.131,0.678c-1.676,0.976-3.646,1.526-5.616,1.568  C19.775,43.256,19,43.341,19,43.405c0,0.211,2.557,1.397,4.044,1.864c4.463,1.377,9.765,0.783,13.746-1.568  c2.829-1.673,5.657-5,6.978-8.221c0.713-1.716,1.425-4.851,1.425-6.354c0-0.975,0.063-1.102,1.236-2.267  c0.692-0.678,1.341-1.419,1.467-1.631c0.21-0.403,0.188-0.403-0.88-0.043c-1.781,0.636-2.033,0.551-1.152-0.402  c0.649-0.678,1.425-1.907,1.425-2.267c0-0.063-0.314,0.042-0.671,0.233c-0.377,0.212-1.215,0.53-1.844,0.72l-1.131,0.361l-1.027-0.7  c-0.566-0.381-1.361-0.805-1.781-0.932C39.766,21.902,38.131,21.944,37.167,22.283z M33,64C16.432,64,3,50.569,3,34S16.432,4,33,4  s30,13.431,30,30S49.568,64,33,64z" style="fill-rule:evenodd;clip-rule:evenodd;fill:;"/></svg>

<span class="new-window"><svg  height="8px"  style="enable-background:new 0 0 1000 1000;" version="1.1" viewBox="0 0 1000 1000" width="8px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" >
<path d="M598 128h298v298h-86v-152l-418 418-60-60 418-418h-152v-86zM810 810v-298h86v298c0 46-40 86-86 86h-596c-48 0-86-40-86-86v-596c0-46 38-86 86-86h298v86h-298v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:;"/>
</svg>
</span></a>




<a href="https://www.linkedin.com/in/liamelliott/" target="_blank" class="link-transition linkedin link dib z-999 pt3 pt0-l mr1" title="LinkedIn link" rel="noopener" aria-label="follow on LinkedIn——Opens in a new window">
  <svg  height="32px"  style="enable-background:new 0 0 65 65;" version="1.1" viewBox="0 0 65 65" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
  <path d="M50.837,48.137V36.425c0-6.275-3.35-9.195-7.816-9.195  c-3.604,0-5.219,1.983-6.119,3.374V27.71h-6.79c0.09,1.917,0,20.427,0,20.427h6.79V36.729c0-0.609,0.044-1.219,0.224-1.655  c0.49-1.22,1.607-2.483,3.482-2.483c2.458,0,3.44,1.873,3.44,4.618v10.929H50.837z M22.959,24.922c2.367,0,3.842-1.57,3.842-3.531  c-0.044-2.003-1.475-3.528-3.797-3.528s-3.841,1.524-3.841,3.528c0,1.961,1.474,3.531,3.753,3.531H22.959z M34,64  C17.432,64,4,50.568,4,34C4,17.431,17.432,4,34,4s30,13.431,30,30C64,50.568,50.568,64,34,64z M26.354,48.137V27.71h-6.789v20.427  H26.354z" style="fill-rule:evenodd;clip-rule:evenodd;fill:;"/>
</svg>

<span class="new-window"><svg  height="8px"  style="enable-background:new 0 0 1000 1000;" version="1.1" viewBox="0 0 1000 1000" width="8px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" >
<path d="M598 128h298v298h-86v-152l-418 418-60-60 418-418h-152v-86zM810 810v-298h86v298c0 46-40 86-86 86h-596c-48 0-86-40-86-86v-596c0-46 38-86 86-86h298v86h-298v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:;"/>
</svg>
</span></a>


<a href="https://github.com/LiamElliott-au" target="_blank" class="link-transition github link dib z-999 pt3 pt0-l mr1" title="Github link" rel="noopener" aria-label="follow on Github——Opens in a new window">
  <svg  height="32px"  style="enable-background:new 0 0 512 512;" version="1.1" viewBox="0 0 512 512" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" >
  <path d="M256,32C132.3,32,32,134.8,32,261.7c0,101.5,64.2,187.5,153.2,217.9c11.2,2.1,15.3-5,15.3-11.1   c0-5.5-0.2-19.9-0.3-39.1c-62.3,13.9-75.5-30.8-75.5-30.8c-10.2-26.5-24.9-33.6-24.9-33.6c-20.3-14.3,1.5-14,1.5-14   c22.5,1.6,34.3,23.7,34.3,23.7c20,35.1,52.4,25,65.2,19.1c2-14.8,7.8-25,14.2-30.7c-49.7-5.8-102-25.5-102-113.5   c0-25.1,8.7-45.6,23-61.6c-2.3-5.8-10-29.2,2.2-60.8c0,0,18.8-6.2,61.6,23.5c17.9-5.1,37-7.6,56.1-7.7c19,0.1,38.2,2.6,56.1,7.7   c42.8-29.7,61.5-23.5,61.5-23.5c12.2,31.6,4.5,55,2.2,60.8c14.3,16.1,23,36.6,23,61.6c0,88.2-52.4,107.6-102.3,113.3   c8,7.1,15.2,21.1,15.2,42.5c0,30.7-0.3,55.5-0.3,63c0,6.1,4,13.3,15.4,11C415.9,449.1,480,363.1,480,261.7   C480,134.8,379.7,32,256,32z"/>
</svg>

<span class="new-window"><svg  height="8px"  style="enable-background:new 0 0 1000 1000;" version="1.1" viewBox="0 0 1000 1000" width="8px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" >
<path d="M598 128h298v298h-86v-152l-418 418-60-60 418-418h-152v-86zM810 810v-298h86v298c0 46-40 86-86 86h-596c-48 0-86-40-86-86v-596c0-46 38-86 86-86h298v86h-298v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:;"/>
</svg>
</span></a>







<a href="index.xml" target="_blank" class="link-transition rss link dib z-999 pt3 pt0-l mr1" title="RSS link" rel="noopener" aria-label="RSS——Opens in a new window">
  <svg xmlns="http://www.w3.org/2000/svg" height="32px" width="32px" viewBox="0 0 24 24">
    <circle cx="6.18" cy="17.82" r="2.18"/>
    <path id="scale" d="M4 4.44v2.83c7.03 0 12.73 5.7 12.73 12.73h2.83c0-8.59-6.97-15.56-15.56-15.56zm0 5.66v2.83c3.9 0 7.07 3.17 7.07 7.07h2.83c0-5.47-4.43-9.9-9.9-9.9z"/>
</svg>


<span class="new-window"><svg  height="8px"  style="enable-background:new 0 0 1000 1000;" version="1.1" viewBox="0 0 1000 1000" width="8px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" >
<path d="M598 128h298v298h-86v-152l-418 418-60-60 418-418h-152v-86zM810 810v-298h86v298c0 46-40 86-86 86h-596c-48 0-86-40-86-86v-596c0-46 38-86 86-86h298v86h-298v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:;"/>
</svg>
</span></a>


    </div>
  </div>
</nav>
    <div class="tc-l pv6 ph3 ph4-ns">
      
    </div>
  </div>
</header>

<a href="https://unsplash.com/photos/jqiAU_JQGyk "
  class="attribution light-silver">Photo by Carlos Alberto Gómez Iñiguez on Unsplash</a>

</div>


  <main class="" role="main">
    

<article class="flex-l flex-wrap justify-between w-75 center ph3 mb-0">
  <div class="serif f4 mid-gray pr4-l w-two-thirds-l">

    <header class="mt3 w-100">
      <h1>SignalR - Why? Because its easy</h1>
      <div class="flex justify-between">
        <div>
          <time class="f5  dib tracked gray"
            datetime="2018-08-21T22:50:00Z">August 21, 2018</time>
          
          <a style="text-decoration-style: dotted;text-decoration-line: underline;"
            class="hover-gray gray helvetica b tracked ml4" href="/blog/" title="Posts page">
            POSTS
          </a>
          
        </div>




<div id="sharing">

  
  <a href="https://www.facebook.com/sharer.php?u=https://drafts.liamelliott.me/blog/2018-08-21-signalr/" class="facebook no-underline" aria-label="share on Facebook">
    <svg height="32px"  style="enable-background:new 0 0 67 67;" version="1.1" viewBox="0 0 67 67" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M28.765,50.32h6.744V33.998h4.499l0.596-5.624h-5.095  l0.007-2.816c0-1.466,0.14-2.253,2.244-2.253h2.812V17.68h-4.5c-5.405,0-7.307,2.729-7.307,7.317v3.377h-3.369v5.625h3.369V50.32z   M33,64C16.432,64,3,50.569,3,34S16.432,4,33,4s30,13.431,30,30S49.568,64,33,64z" style="fill-rule:evenodd;clip-rule:evenodd;"/></svg>

  </a>

  
  
  <a href="https://twitter.com/share?url=https://drafts.liamelliott.me/blog/2018-08-21-signalr/&amp;text=SignalR%20-%20Why?%20Because%20its%20easy" class="twitter no-underline" aria-label="share on Twitter">
    <svg height="32px"  style="enable-background:new 0 0 67 67;" version="1.1" viewBox="0 0 67 67" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167,22.283c-2.619,0.953-4.274,3.411-4.086,6.101  l0.063,1.038l-1.048-0.127c-3.813-0.487-7.145-2.139-9.974-4.915l-1.383-1.377l-0.356,1.017c-0.754,2.267-0.272,4.661,1.299,6.271  c0.838,0.89,0.649,1.017-0.796,0.487c-0.503-0.169-0.943-0.296-0.985-0.233c-0.146,0.149,0.356,2.076,0.754,2.839  c0.545,1.06,1.655,2.097,2.871,2.712l1.027,0.487l-1.215,0.021c-1.173,0-1.215,0.021-1.089,0.467  c0.419,1.377,2.074,2.839,3.918,3.475l1.299,0.444l-1.131,0.678c-1.676,0.976-3.646,1.526-5.616,1.568  C19.775,43.256,19,43.341,19,43.405c0,0.211,2.557,1.397,4.044,1.864c4.463,1.377,9.765,0.783,13.746-1.568  c2.829-1.673,5.657-5,6.978-8.221c0.713-1.716,1.425-4.851,1.425-6.354c0-0.975,0.063-1.102,1.236-2.267  c0.692-0.678,1.341-1.419,1.467-1.631c0.21-0.403,0.188-0.403-0.88-0.043c-1.781,0.636-2.033,0.551-1.152-0.402  c0.649-0.678,1.425-1.907,1.425-2.267c0-0.063-0.314,0.042-0.671,0.233c-0.377,0.212-1.215,0.53-1.844,0.72l-1.131,0.361l-1.027-0.7  c-0.566-0.381-1.361-0.805-1.781-0.932C39.766,21.902,38.131,21.944,37.167,22.283z M33,64C16.432,64,3,50.569,3,34S16.432,4,33,4  s30,13.431,30,30S49.568,64,33,64z" style="fill-rule:evenodd;clip-rule:evenodd;fill:;"/></svg>

  </a>

  
  <a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://drafts.liamelliott.me/blog/2018-08-21-signalr/&amp;title=SignalR%20-%20Why?%20Because%20its%20easy" class="linkedin no-underline" aria-label="share on LinkedIn">
    <svg  height="32px"  style="enable-background:new 0 0 65 65;" version="1.1" viewBox="0 0 65 65" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
  <path d="M50.837,48.137V36.425c0-6.275-3.35-9.195-7.816-9.195  c-3.604,0-5.219,1.983-6.119,3.374V27.71h-6.79c0.09,1.917,0,20.427,0,20.427h6.79V36.729c0-0.609,0.044-1.219,0.224-1.655  c0.49-1.22,1.607-2.483,3.482-2.483c2.458,0,3.44,1.873,3.44,4.618v10.929H50.837z M22.959,24.922c2.367,0,3.842-1.57,3.842-3.531  c-0.044-2.003-1.475-3.528-3.797-3.528s-3.841,1.524-3.841,3.528c0,1.961,1.474,3.531,3.753,3.531H22.959z M34,64  C17.432,64,4,50.568,4,34C4,17.431,17.432,4,34,4s30,13.431,30,30C64,50.568,50.568,64,34,64z M26.354,48.137V27.71h-6.789v20.427  H26.354z" style="fill-rule:evenodd;clip-rule:evenodd;fill:;"/>
</svg>

  </a>
</div>
</div><ul class="pa0 mv0 flex flex-wrap b tracked ">
  
  <li class="list">
    <a href="/tags/angular" class="link f6  mr2 light-silver sans-serif"
      style="text-decoration-style: dotted;text-decoration-line: underline;">angular</a>
  </li>
  
  <li class="list">
    <a href="/tags/signalr" class="link f6  mr2 light-silver sans-serif"
      style="text-decoration-style: dotted;text-decoration-line: underline;">signalr</a>
  </li>
  
  <li class="list">
    <a href="/tags/realtime" class="link f6  mr2 light-silver sans-serif"
      style="text-decoration-style: dotted;text-decoration-line: underline;">realtime</a>
  </li>
  
  <li class="list">
    <a href="/tags/asp-net-core" class="link f6  mr2 light-silver sans-serif"
      style="text-decoration-style: dotted;text-decoration-line: underline;">asp-net-core</a>
  </li>
  
</ul>
      
    </header>
    <div
      class="nested-copy-line-height lh-copy serif f4 nested-links nested-img mid-gray">
      
      <p class="teaser">
        SignalR has been around for a few years now (since 2013), offering real-time notifications to our .Net applications.
      </p>
      <p>SignalR has been around for a few years now (since 2013), offering real-time notifications to our .Net applications.</p>
<p>I was always hesitant to implement any type of real-time notifications into my applications based on the following assumptions:</p>
<ol>
<li>I work on enterprise applications, and my users don&rsquo;t really need/expect it</li>
<li>It&rsquo;s too hard</li>
</ol>
<p><strong>Assumption 1: Users don&rsquo;t need it</strong></p>
<p>Well, this is just an excuse to avoid the pain of implementation. In the modern web, our users are trained to expect responsive applications and to have information pushed to them: Message notifications, Emails, Tweets, it all happens quite subtly, but honestly, our users these days (especially in the world of Single-Page-Apps) really aren&rsquo;t used to hitting refresh. My users are no different. If they don&rsquo;t receive real-time feedback, they think the entire processing pipeline has faulted.</p>
<p><strong>Assumption 2: It&rsquo;s too hard</strong></p>
<p><em>Wrong</em>. Boy, was I wrong in that one too. With the release of ASP.NET Core 2.1 Microsoft has baked SignalR into the framework and made it so simple for us to add it to our websites.</p>
<p>As I&rsquo;ve added SignalR to my production Angular/Web API apps, I&rsquo;ve distilled the process into four simple steps for both the server and the client, and I want to show how <strong>easy</strong> it really is</p>
<h2 id="adding-signalr-to-existing-api">Adding SignalR to existing API</h2>
<h2 id="step-1-create-a-hub">Step 1. Create a Hub</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#66d9ef">namespace</span> ShoppingList.Api.SignalR
{
  <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ShoppingListHub</span> : Hub
  {
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">string</span> SHOPPINGLIST_GROUP = <span style="color:#e6db74">&#34;ShoppingList_&#34;</span>;
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">async</span> Task JoinList(<span style="color:#66d9ef">string</span> listId)
    {
        <span style="color:#66d9ef">await</span> Groups.AddToGroupAsync(<span style="color:#66d9ef">this</span>.Context.ConnectionId, <span style="color:#e6db74">$&#34;{SHOPPINGLIST_GROUP}{listId}&#34;</span>);
    }

    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">async</span> Task LeaveList(<span style="color:#66d9ef">string</span> listId)
    {
        <span style="color:#66d9ef">await</span> Groups.RemoveFromGroupAsync(<span style="color:#66d9ef">this</span>.Context.ConnectionId, <span style="color:#e6db74">$&#34;{SHOPPINGLIST_GROUP}{listId}&#34;</span>);
    }
  }
}
</code></pre></div><p>Our hub is effectively the controller of our SignalR channel. There is very little (actually nothing) that needs to live in our hub. In this implementation, I do have two methods: JoinList() and LeaveList() these methods allow users to subscribe and unsubscribe to groups, so we can broadcast messages only to those clients that have subscribed to the group.</p>
<h2 id="step-2-create-a-notification-service-optional">Step 2: Create a notification service (optional)</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ShoppingListNotificationService</span> : IShoppingListNotificationService
{
  <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">readonly</span> IHubContext&lt;ShoppingListHub&gt; hub;
  <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">readonly</span> ShoppingListDbContext db;

  <span style="color:#66d9ef">public</span> ShoppingListNotificationService(IHubContext&lt;ShoppingListHub&gt; hub, ShoppingListDbContext db)
  {
      <span style="color:#66d9ef">this</span>.hub = hub;
      <span style="color:#66d9ef">this</span>.db = db;
  }
  
  <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">async</span> Task NotifyShoppingListItemAdded(<span style="color:#66d9ef">int</span> shoppingListId, ShoppingListItem item)
  {
      <span style="color:#66d9ef">var</span> <span style="color:#66d9ef">group</span> = hub.Clients.Group(<span style="color:#e6db74">$&#34;{ShoppingListHub.SHOPPINGLIST_GROUP}{shoppingListId}&#34;</span>);
      <span style="color:#66d9ef">await</span> <span style="color:#66d9ef">group</span>.SendAsync(<span style="color:#e6db74">&#34;ShoppingListItem_Added&#34;</span>, item);
  }
  
  <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">async</span> Task NotifyShoppingListItemUpdated(<span style="color:#66d9ef">int</span> shoppingListId, ShoppingListItem item)
  {
      <span style="color:#66d9ef">var</span> <span style="color:#66d9ef">group</span> = hub.Clients.Group(<span style="color:#e6db74">$&#34;{ShoppingListHub.SHOPPINGLIST_GROUP}{shoppingListId}&#34;</span>);
      <span style="color:#66d9ef">await</span> <span style="color:#66d9ef">group</span>.SendAsync(<span style="color:#e6db74">&#34;ShoppingListItem_Updated&#34;</span>, item);
  }
  
  <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">async</span> Task NotifyShoppingListUpdated(Entities.ShoppingList item)
  {
      <span style="color:#66d9ef">var</span> <span style="color:#66d9ef">group</span> = hub.Clients.Group(<span style="color:#e6db74">$&#34;{ShoppingListHub.SHOPPINGLIST_GROUP}{item.Id}&#34;</span>);
      <span style="color:#66d9ef">await</span> <span style="color:#66d9ef">group</span>.SendAsync(<span style="color:#e6db74">&#34;ShoppingList_Updated&#34;</span>, item);
  }
  
  <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">async</span> Task NotifyRefreshList()
  {
      <span style="color:#66d9ef">await</span> hub.Clients.All.SendAsync(<span style="color:#e6db74">&#34;ShoppingLists_Refresh&#34;</span>, db.ShoppingLists);
  }
}
</code></pre></div><p>This service is completely optional, but it allows us to encapsulate the calls to SignalR in one central location, and use it throughout our application. Within each message, we then broadcast the message to either all connected clients, or to a specific group of clients (Those that subscribed via the previous JoinList() method).</p>
<h2 id="step-3-update-api-controllers">Step 3: Update API Controllers</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#a6e22e">[HttpPost(&#34;{shoppingListId}/Items&#34;)]</span>
<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">async</span> Task&lt;IActionResult&gt; PostItem(<span style="color:#66d9ef">int</span> shoppingListId, [FromBody] ShoppingListItem item)
{
<span style="color:#75715e">//...code removed for brevity
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">await</span> notifications.NotifyShoppingListItemAdded(shoppingListId, item);
  <span style="color:#66d9ef">return</span> CreatedAtRoute(<span style="color:#e6db74">&#34;ShoppingListItem&#34;</span>, <span style="color:#66d9ef">new</span> { shoppingListId, item.Id }, item);
}
</code></pre></div><p>As items are Created, Updated or Deleted, we now ask the notification service to send the appropriate message.</p>
<h2 id="step-4-configure-startupcs">Step 4: Configure Startup.cs</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> ConfigureServices(IServiceCollection services)
{
<span style="color:#75715e">//Excess code removed for readability
</span><span style="color:#75715e"></span>
  <span style="color:#75715e">//Turn on SignalR
</span><span style="color:#75715e"></span>  services.AddSignalR();

  <span style="color:#75715e">//Register our Notification service in the DI Container
</span><span style="color:#75715e"></span>  services.AddTransient&lt;IShoppingListNotificationService, ShoppingListNotificationService&gt;();
}

<span style="color:#75715e">// This method gets called by the runtime. Use this method to configure the HTTP request pipeline.
</span><span style="color:#75715e"></span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> Configure(IApplicationBuilder app, IHostingEnvironment env)
{
<span style="color:#75715e">//Excess code removed for readability
</span><span style="color:#75715e"></span>
  <span style="color:#75715e">//Configure the Hub endpoint
</span><span style="color:#75715e"></span>  app.UseSignalR(route =&gt;
  {
    route.MapHub&lt;ShoppingListHub&gt;(<span style="color:#e6db74">&#34;/hubs/shoppingLists&#34;</span>);
  });
}
</code></pre></div><p>In ASP.NET Core 2.1 there is really only 2 steps required here:</p>
<ol>
<li>Add SignalR to your services
a. <em>optional</em>: Register your notification service with the DI container</li>
<li>Map the hub to a SignalR endpoint</li>
</ol>
<h1 id="adding-signalr-to-existing-angular-client">Adding SignalR to existing Angular Client</h1>
<h2 id="step-1-install-the-signalr-client">Step 1: Install the SignalR client</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cmd" data-lang="cmd">  npm -i --save @aspnet/signalr
</code></pre></div><h2 id="step-2-create-a-service-to-manage-the-connection">Step 2: Create a service to manage the connection</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-typescript" data-lang="typescript"><span style="color:#66d9ef">@Injectable</span>({
  <span style="color:#a6e22e">providedIn</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;root&#39;</span>
})
<span style="color:#66d9ef">export</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">SignalRService</span> {

  <span style="color:#66d9ef">private</span> <span style="color:#a6e22e">_hubConnection</span>: <span style="color:#66d9ef">HubConnection</span>;
  <span style="color:#a6e22e">isConnected</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">false</span>;

  <span style="color:#66d9ef">constructor</span>() {
    <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">init</span>();
  }

  <span style="color:#66d9ef">private</span> <span style="color:#a6e22e">init() {</span>
    <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">_hubConnection</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">HubConnectionBuilder</span>()
    .<span style="color:#a6e22e">withUrl</span>(<span style="color:#e6db74">&#39;http://localhost:18111/hubs/shoppingLists&#39;</span>)
    .<span style="color:#a6e22e">build</span>();

    <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">_hubConnection</span>.<span style="color:#a6e22e">onclose</span>(<span style="color:#a6e22e">e</span> <span style="color:#f92672">=&gt;</span> {
      <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">isConnected</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">false</span>;
        <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">e</span>) {
          <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#39;Hub connection closed due to the following error&#39;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">name</span>);
          <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">message</span>);
          <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">connect</span>();
        } <span style="color:#66d9ef">else</span> {
          <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#39;Hub connection closed&#39;</span>);
        }
    });
  }

  <span style="color:#a6e22e">connect() {</span>
    <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">_hubConnection</span>.<span style="color:#a6e22e">start</span>()
    .<span style="color:#a6e22e">then</span>(() <span style="color:#f92672">=&gt;</span> {
      <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">isConnected</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">true</span>;
      <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#39;Hub connection started&#39;</span>);
    })
    .<span style="color:#66d9ef">catch</span>(<span style="color:#a6e22e">err</span> <span style="color:#f92672">=&gt;</span> {
        <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">isConnected</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">false</span>;
        <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#39;Error while establishing connection&#39;</span>);
    });
  }
}
</code></pre></div><p>The first part here is to build our hub connection and point it to the endpoint configured on the server. Then we need to remember to Start() our connection when we want to start listening to events.</p>
<p>Next, we want to listen to all the events that we configured in the notification service on the server</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-typescript" data-lang="typescript"><span style="color:#a6e22e">shoppingListItemAdded</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Subject</span>&lt;<span style="color:#f92672">ShoppingListItem</span>&gt;();
<span style="color:#a6e22e">shoppingListItemUpdated</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Subject</span>&lt;<span style="color:#f92672">ShoppingListItem</span>&gt;();

<span style="color:#a6e22e">init</span>(){
<span style="color:#75715e">//previous steps removed for clarity
</span><span style="color:#75715e"></span>
  <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">_hubConnection</span>.<span style="color:#a6e22e">on</span>(<span style="color:#e6db74">&#39;ShoppingListItem_Added&#39;</span>, (<span style="color:#a6e22e">item</span>: <span style="color:#66d9ef">ShoppingListItem</span>) <span style="color:#f92672">=&gt;</span> {
    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#39;Item Added: &#39;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">item</span>.<span style="color:#a6e22e">id</span>);
    <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">shoppingListItemAdded</span>.<span style="color:#a6e22e">next</span>(<span style="color:#a6e22e">item</span>);
  });

  <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">_hubConnection</span>.<span style="color:#a6e22e">on</span>(<span style="color:#e6db74">&#39;ShoppingListItem_Updated&#39;</span>, (<span style="color:#a6e22e">item</span>: <span style="color:#66d9ef">ShoppingListItem</span>) <span style="color:#f92672">=&gt;</span> {
    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#39;Item Updated: &#39;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">item</span>.<span style="color:#a6e22e">id</span>);
    <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">shoppingListItemUpdated</span>.<span style="color:#a6e22e">next</span>(<span style="color:#a6e22e">item</span>);
  });

<span style="color:#75715e">//The remaining events are handled in the same way
</span><span style="color:#75715e"></span>}
</code></pre></div><p>We are now listening to each event being raised and storing the results in an RxJS Subject.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-typescript" data-lang="typescript"><span style="color:#a6e22e">joinShoppingList</span>(<span style="color:#a6e22e">id</span>: <span style="color:#66d9ef">number</span>) {
  <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">_hubConnection</span>.<span style="color:#a6e22e">invoke</span>(<span style="color:#e6db74">&#39;JoinList&#39;</span>, <span style="color:#a6e22e">id</span>);
}

<span style="color:#a6e22e">leaveShoppingList</span>(<span style="color:#a6e22e">id</span>: <span style="color:#66d9ef">number</span>) {
  <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">_hubConnection</span>.<span style="color:#a6e22e">invoke</span>(<span style="color:#e6db74">&#39;LeaveList&#39;</span>, <span style="color:#a6e22e">id</span>);
}
</code></pre></div><p>Finally, we need the ability to invoke the JoinList() and LeaveList() methods we created on the hub.</p>
<h3 id="signalrservicets">SignalR.service.ts</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-typescript" data-lang="typescript"><span style="color:#66d9ef">@Injectable</span>({
  <span style="color:#a6e22e">providedIn</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;root&#39;</span>
})
<span style="color:#66d9ef">export</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">SignalRService</span> {

  <span style="color:#66d9ef">private</span> <span style="color:#a6e22e">_hubConnection</span>: <span style="color:#66d9ef">HubConnection</span>;
  <span style="color:#a6e22e">isConnected</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">false</span>;

  <span style="color:#a6e22e">shoppingListsRefresh</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Subject</span>();
  <span style="color:#a6e22e">shoppingListItemAdded</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Subject</span>&lt;<span style="color:#f92672">ShoppingListItem</span>&gt;();
  <span style="color:#a6e22e">shoppingListItemUpdated</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Subject</span>&lt;<span style="color:#f92672">ShoppingListItem</span>&gt;();
  <span style="color:#a6e22e">shoppingListUpdated</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Subject</span>&lt;<span style="color:#f92672">ShoppingList</span>&gt;();

  <span style="color:#66d9ef">constructor</span>() {
    <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">init</span>();
  }

  <span style="color:#66d9ef">private</span> <span style="color:#a6e22e">init() {</span>
    <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">_hubConnection</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">HubConnectionBuilder</span>()
      .<span style="color:#a6e22e">withUrl</span>(<span style="color:#e6db74">&#39;http://localhost:18111/hubs/shoppingLists&#39;</span>)
      .<span style="color:#a6e22e">build</span>();
  
    <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">_hubConnection</span>.<span style="color:#a6e22e">on</span>(<span style="color:#e6db74">&#39;ShoppingListItem_Added&#39;</span>, (<span style="color:#a6e22e">item</span>: <span style="color:#66d9ef">ShoppingListItem</span>) <span style="color:#f92672">=&gt;</span> {
      <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#39;Item Added: &#39;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">item</span>.<span style="color:#a6e22e">id</span>);
      <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">shoppingListItemAdded</span>.<span style="color:#a6e22e">next</span>(<span style="color:#a6e22e">item</span>);
    });

    <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">_hubConnection</span>.<span style="color:#a6e22e">on</span>(<span style="color:#e6db74">&#39;ShoppingListItem_Updated&#39;</span>, (<span style="color:#a6e22e">item</span>: <span style="color:#66d9ef">ShoppingListItem</span>) <span style="color:#f92672">=&gt;</span> {
      <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#39;Item Updated: &#39;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">item</span>.<span style="color:#a6e22e">id</span>);
      <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">shoppingListItemUpdated</span>.<span style="color:#a6e22e">next</span>(<span style="color:#a6e22e">item</span>);
    });

    <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">_hubConnection</span>.<span style="color:#a6e22e">on</span>(<span style="color:#e6db74">&#39;ShoppingList_Updated&#39;</span>, (<span style="color:#a6e22e">list</span>: <span style="color:#66d9ef">ShoppingList</span>) <span style="color:#f92672">=&gt;</span> {
      <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#39;ShoppingListUpdated: &#39;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">list</span>.<span style="color:#a6e22e">id</span>);
      <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">shoppingListUpdated</span>.<span style="color:#a6e22e">next</span>(<span style="color:#a6e22e">list</span>);
     });

     <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">_hubConnection</span>.<span style="color:#a6e22e">on</span>(<span style="color:#e6db74">&#39;ShoppingLists_Refresh&#39;</span>, () <span style="color:#f92672">=&gt;</span> {
      <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#39;Refreshing Lists&#39;</span>);
      <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">shoppingListsRefresh</span>.<span style="color:#a6e22e">next</span>();
     });

    <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">_hubConnection</span>.<span style="color:#a6e22e">onclose</span>(<span style="color:#a6e22e">e</span> <span style="color:#f92672">=&gt;</span> {
      <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">isConnected</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">false</span>;
      <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">e</span>) {
        <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#39;Hub connection closed due to the following error&#39;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">name</span>);
        <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">message</span>);
        <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">connect</span>();
        } <span style="color:#66d9ef">else</span> {
        <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#39;Hub connection closed&#39;</span>);
      }
    });
  }

  <span style="color:#a6e22e">connect() {</span>

    <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">_hubConnection</span>.<span style="color:#a6e22e">start</span>()
    .<span style="color:#a6e22e">then</span>(() <span style="color:#f92672">=&gt;</span> {
        <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">isConnected</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">true</span>;
        <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#39;Hub connection started&#39;</span>);
    })
    .<span style="color:#66d9ef">catch</span>(<span style="color:#a6e22e">err</span> <span style="color:#f92672">=&gt;</span> {
        <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">isConnected</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">false</span>;
        <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#39;Error while establishing connection&#39;</span>);
    });
  }

  <span style="color:#a6e22e">joinShoppingList</span>(<span style="color:#a6e22e">id</span>: <span style="color:#66d9ef">number</span>) {
    <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">_hubConnection</span>.<span style="color:#a6e22e">invoke</span>(<span style="color:#e6db74">&#39;JoinList&#39;</span>, <span style="color:#a6e22e">id</span>);
  }

  <span style="color:#a6e22e">leaveShoppingList</span>(<span style="color:#a6e22e">id</span>: <span style="color:#66d9ef">number</span>) {
    <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">_hubConnection</span>.<span style="color:#a6e22e">invoke</span>(<span style="color:#e6db74">&#39;LeaveList&#39;</span>, <span style="color:#a6e22e">id</span>);
  }
}
</code></pre></div><h3 id="step-3-update-the-components">Step 3: Update the Components</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-typescript" data-lang="typescript"><span style="color:#a6e22e">ngOnInit() {</span>
  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">param$</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">route</span>.<span style="color:#a6e22e">params</span>.<span style="color:#a6e22e">pipe</span>(
    <span style="color:#a6e22e">pluck</span>(<span style="color:#e6db74">&#39;id&#39;</span>),
    <span style="color:#a6e22e">tap</span>(<span style="color:#a6e22e">id</span> <span style="color:#f92672">=&gt;</span> {
      <span style="color:#66d9ef">if</span> (<span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">currentId</span>) {
        <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">signalR</span>.<span style="color:#a6e22e">leaveShoppingList</span>(<span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">currentId</span>);
      }
    }),
    <span style="color:#a6e22e">tap</span>(<span style="color:#a6e22e">id</span> <span style="color:#f92672">=&gt;</span> {
      <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">signalR</span>.<span style="color:#a6e22e">joinShoppingList</span>(<span style="color:#f92672">+</span><span style="color:#a6e22e">id</span>);
      <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">currentId</span> <span style="color:#f92672">=</span> <span style="color:#f92672">+</span><span style="color:#a6e22e">id</span>;
    }),
    <span style="color:#a6e22e">switchMap</span>(<span style="color:#a6e22e">id</span> <span style="color:#f92672">=&gt;</span> {
      <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">id</span> <span style="color:#f92672">===</span> <span style="color:#e6db74">&#39;new&#39;</span>) {
        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">of</span>(<span style="color:#66d9ef">new</span> <span style="color:#a6e22e">ShoppingList</span>());
      } <span style="color:#66d9ef">else</span> {
        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">service</span>.<span style="color:#66d9ef">get</span>(<span style="color:#f92672">+</span><span style="color:#a6e22e">id</span>);
      }
    })
  );

  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">itemRefresh$</span> <span style="color:#f92672">=</span>
    <span style="color:#a6e22e">merge</span>(<span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">signalR</span>.<span style="color:#a6e22e">shoppingListItemAdded</span>, <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">signalR</span>.<span style="color:#a6e22e">shoppingListItemUpdated</span>).<span style="color:#a6e22e">pipe</span>(
      <span style="color:#a6e22e">switchMap</span>(() <span style="color:#f92672">=&gt;</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">service</span>.<span style="color:#66d9ef">get</span>(<span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">currentId</span>))
    );

    <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">list$</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">merge</span>(<span style="color:#a6e22e">param$</span>, <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">signalR</span>.<span style="color:#a6e22e">shoppingListUpdated</span>, <span style="color:#a6e22e">itemRefresh$</span>);
  }
</code></pre></div><p>Here, we do a few things. First up, configure our listener to the route being updated, and unsubscribe/subscribe to the desired lists notifications, then we also fetch the desired list from the server. Secondly, we merge the two Subjects from the notification service that we are interested in, and finally, we merge all the required triggers into one observable that ultimately populates the list$ property with the most current data from the server.</p>
<h3 id="conclusion">Conclusion</h3>
<ol>
<li>Microsoft has made it almost too trivial to add push notifications to your ASP.NET Core applications.</li>
<li>The client library is simply JS, as such can be used on any front-end</li>
<li>RxJS really simplifies our client code to merge the varying streams of information into one simple observable.</li>
</ol>
<p>If you are interested in any of the code on this post, you can find it <a href="https://github.com/LiamElliott-au/shoppinglists-aspnetcore-signalr-angular-react">here on Github</a>.</p><div class="mt6 instapaper_ignoref">
        
        
      </div>
    </div>
  </div>
  <aside class="w-30-l mt4"><div class="br3 ba b--moon-gray bg-light-gray ph4 mid-gray">
  <h2 class="tracked flex justify-between items-end">
    About
    <img class="br-100 h3 w3 dib" src="/images/head.jpg" />
  </h2>
  <hr />

  <p class="lh-copy">
    Hi, I am <strong>Liam Elliott</strong>. Father of 2, Trail runner and
    Solution Architect at SSW here in Sydney. With over 12 years of experience
    developing enterprise applications, primarily in AspNet Core and Angular.
    <a href="/about">more...</a>
  </p>
</div></aside><footer>
    <p></p>
    <h4>Share</h4>




<div id="sharing">

  
  <a href="https://www.facebook.com/sharer.php?u=https://drafts.liamelliott.me/blog/2018-08-21-signalr/" class="facebook no-underline" aria-label="share on Facebook">
    <svg height="32px"  style="enable-background:new 0 0 67 67;" version="1.1" viewBox="0 0 67 67" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M28.765,50.32h6.744V33.998h4.499l0.596-5.624h-5.095  l0.007-2.816c0-1.466,0.14-2.253,2.244-2.253h2.812V17.68h-4.5c-5.405,0-7.307,2.729-7.307,7.317v3.377h-3.369v5.625h3.369V50.32z   M33,64C16.432,64,3,50.569,3,34S16.432,4,33,4s30,13.431,30,30S49.568,64,33,64z" style="fill-rule:evenodd;clip-rule:evenodd;"/></svg>

  </a>

  
  
  <a href="https://twitter.com/share?url=https://drafts.liamelliott.me/blog/2018-08-21-signalr/&amp;text=SignalR%20-%20Why?%20Because%20its%20easy" class="twitter no-underline" aria-label="share on Twitter">
    <svg height="32px"  style="enable-background:new 0 0 67 67;" version="1.1" viewBox="0 0 67 67" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167,22.283c-2.619,0.953-4.274,3.411-4.086,6.101  l0.063,1.038l-1.048-0.127c-3.813-0.487-7.145-2.139-9.974-4.915l-1.383-1.377l-0.356,1.017c-0.754,2.267-0.272,4.661,1.299,6.271  c0.838,0.89,0.649,1.017-0.796,0.487c-0.503-0.169-0.943-0.296-0.985-0.233c-0.146,0.149,0.356,2.076,0.754,2.839  c0.545,1.06,1.655,2.097,2.871,2.712l1.027,0.487l-1.215,0.021c-1.173,0-1.215,0.021-1.089,0.467  c0.419,1.377,2.074,2.839,3.918,3.475l1.299,0.444l-1.131,0.678c-1.676,0.976-3.646,1.526-5.616,1.568  C19.775,43.256,19,43.341,19,43.405c0,0.211,2.557,1.397,4.044,1.864c4.463,1.377,9.765,0.783,13.746-1.568  c2.829-1.673,5.657-5,6.978-8.221c0.713-1.716,1.425-4.851,1.425-6.354c0-0.975,0.063-1.102,1.236-2.267  c0.692-0.678,1.341-1.419,1.467-1.631c0.21-0.403,0.188-0.403-0.88-0.043c-1.781,0.636-2.033,0.551-1.152-0.402  c0.649-0.678,1.425-1.907,1.425-2.267c0-0.063-0.314,0.042-0.671,0.233c-0.377,0.212-1.215,0.53-1.844,0.72l-1.131,0.361l-1.027-0.7  c-0.566-0.381-1.361-0.805-1.781-0.932C39.766,21.902,38.131,21.944,37.167,22.283z M33,64C16.432,64,3,50.569,3,34S16.432,4,33,4  s30,13.431,30,30S49.568,64,33,64z" style="fill-rule:evenodd;clip-rule:evenodd;fill:;"/></svg>

  </a>

  
  <a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://drafts.liamelliott.me/blog/2018-08-21-signalr/&amp;title=SignalR%20-%20Why?%20Because%20its%20easy" class="linkedin no-underline" aria-label="share on LinkedIn">
    <svg  height="32px"  style="enable-background:new 0 0 65 65;" version="1.1" viewBox="0 0 65 65" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
  <path d="M50.837,48.137V36.425c0-6.275-3.35-9.195-7.816-9.195  c-3.604,0-5.219,1.983-6.119,3.374V27.71h-6.79c0.09,1.917,0,20.427,0,20.427h6.79V36.729c0-0.609,0.044-1.219,0.224-1.655  c0.49-1.22,1.607-2.483,3.482-2.483c2.458,0,3.44,1.873,3.44,4.618v10.929H50.837z M22.959,24.922c2.367,0,3.842-1.57,3.842-3.531  c-0.044-2.003-1.475-3.528-3.797-3.528s-3.841,1.524-3.841,3.528c0,1.961,1.474,3.531,3.753,3.531H22.959z M34,64  C17.432,64,4,50.568,4,34C4,17.431,17.432,4,34,4s30,13.431,30,30C64,50.568,50.568,64,34,64z M26.354,48.137V27.71h-6.789v20.427  H26.354z" style="fill-rule:evenodd;clip-rule:evenodd;fill:;"/>
</svg>

  </a>
</div>
<hr />
    
    <h2>More from Posts</h2>
    

    <div class="flex-ns flex-wrap justify-around">
        

<article >
  <a href="https://drafts.liamelliott.me/blog/2018-06-03-rxjs-refactor-behavioursubjects/" class="db pv4 ph0-l no-underline black dim">
  
  
  <div class="flex flex-column flex-row-ns">
    <div class="pr3-ns mb4 mb0-ns w-100 w-40-ns">
      
      <img src="https://drafts.liamelliott.me/images/headers/lucian-andrei-600146-unsplash.jpg" class="db" alt="image from RxJS refactor: BehaviourSubjects">
      
    </div>
      
      <div class="w-100 w-60-ns pl3-ns">
        <h1 class="f3 fw1 nt0 lh-title">RxJS refactor: BehaviourSubjects</h1>
        <p class="f6 lh-copy mv0">Jun 3, 2018</p>
        <p class="f6 f5-l lh-copy">
          Using RxJS BehaviourSubjects to tidy up our code and remove tight coupling between the Template and the component, whilst also providing hooks  to trigger data updates.
        </p>
      </div>
  </div>
  </a>
</article>

        

<article >
  <a href="https://drafts.liamelliott.me/blog/2019-01-08-welcome-to-2019/" class="db pv4 ph0-l no-underline black dim">
  
  
  <div class="flex flex-column flex-row-ns">
    <div class="pr3-ns mb4 mb0-ns w-100 w-40-ns">
      
      <img src="https://drafts.liamelliott.me/images/headers/kristine-weilert-88989-unsplash.jpg" class="db" alt="image from New years goals">
      
    </div>
      
      <div class="w-100 w-60-ns pl3-ns">
        <h1 class="f3 fw1 nt0 lh-title">New years goals</h1>
        <p class="f6 lh-copy mv0">Jan 8, 2019</p>
        <p class="f6 f5-l lh-copy">
          <p>I&rsquo;ve never been one to set myself new years resolutions, not for any particular reason, I just don&rsquo;t. However, last year I set myself several goals and/or challenges.</p>
        </p>
      </div>
  </div>
  </a>
</article>
    </div>
</footer></article>



  </main>
  <footer class="bg-black bottom-0 w-100 pa2" role="contentinfo">
  <div class="flex justify-between">
  <a class="f6 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="https://drafts.liamelliott.me/" >
    &copy;  Liam Elliott 2020 
  </a>
    <div>




<a href="https://twitter.com/LiamElliott_au" target="_blank" class="link-transition twitter link dib z-999 pt3 pt0-l mr1" title="Twitter link" rel="noopener" aria-label="follow on Twitter——Opens in a new window">
  <svg height="32px"  style="enable-background:new 0 0 67 67;" version="1.1" viewBox="0 0 67 67" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167,22.283c-2.619,0.953-4.274,3.411-4.086,6.101  l0.063,1.038l-1.048-0.127c-3.813-0.487-7.145-2.139-9.974-4.915l-1.383-1.377l-0.356,1.017c-0.754,2.267-0.272,4.661,1.299,6.271  c0.838,0.89,0.649,1.017-0.796,0.487c-0.503-0.169-0.943-0.296-0.985-0.233c-0.146,0.149,0.356,2.076,0.754,2.839  c0.545,1.06,1.655,2.097,2.871,2.712l1.027,0.487l-1.215,0.021c-1.173,0-1.215,0.021-1.089,0.467  c0.419,1.377,2.074,2.839,3.918,3.475l1.299,0.444l-1.131,0.678c-1.676,0.976-3.646,1.526-5.616,1.568  C19.775,43.256,19,43.341,19,43.405c0,0.211,2.557,1.397,4.044,1.864c4.463,1.377,9.765,0.783,13.746-1.568  c2.829-1.673,5.657-5,6.978-8.221c0.713-1.716,1.425-4.851,1.425-6.354c0-0.975,0.063-1.102,1.236-2.267  c0.692-0.678,1.341-1.419,1.467-1.631c0.21-0.403,0.188-0.403-0.88-0.043c-1.781,0.636-2.033,0.551-1.152-0.402  c0.649-0.678,1.425-1.907,1.425-2.267c0-0.063-0.314,0.042-0.671,0.233c-0.377,0.212-1.215,0.53-1.844,0.72l-1.131,0.361l-1.027-0.7  c-0.566-0.381-1.361-0.805-1.781-0.932C39.766,21.902,38.131,21.944,37.167,22.283z M33,64C16.432,64,3,50.569,3,34S16.432,4,33,4  s30,13.431,30,30S49.568,64,33,64z" style="fill-rule:evenodd;clip-rule:evenodd;fill:;"/></svg>

<span class="new-window"><svg  height="8px"  style="enable-background:new 0 0 1000 1000;" version="1.1" viewBox="0 0 1000 1000" width="8px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" >
<path d="M598 128h298v298h-86v-152l-418 418-60-60 418-418h-152v-86zM810 810v-298h86v298c0 46-40 86-86 86h-596c-48 0-86-40-86-86v-596c0-46 38-86 86-86h298v86h-298v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:;"/>
</svg>
</span></a>




<a href="https://www.linkedin.com/in/liamelliott/" target="_blank" class="link-transition linkedin link dib z-999 pt3 pt0-l mr1" title="LinkedIn link" rel="noopener" aria-label="follow on LinkedIn——Opens in a new window">
  <svg  height="32px"  style="enable-background:new 0 0 65 65;" version="1.1" viewBox="0 0 65 65" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
  <path d="M50.837,48.137V36.425c0-6.275-3.35-9.195-7.816-9.195  c-3.604,0-5.219,1.983-6.119,3.374V27.71h-6.79c0.09,1.917,0,20.427,0,20.427h6.79V36.729c0-0.609,0.044-1.219,0.224-1.655  c0.49-1.22,1.607-2.483,3.482-2.483c2.458,0,3.44,1.873,3.44,4.618v10.929H50.837z M22.959,24.922c2.367,0,3.842-1.57,3.842-3.531  c-0.044-2.003-1.475-3.528-3.797-3.528s-3.841,1.524-3.841,3.528c0,1.961,1.474,3.531,3.753,3.531H22.959z M34,64  C17.432,64,4,50.568,4,34C4,17.431,17.432,4,34,4s30,13.431,30,30C64,50.568,50.568,64,34,64z M26.354,48.137V27.71h-6.789v20.427  H26.354z" style="fill-rule:evenodd;clip-rule:evenodd;fill:;"/>
</svg>

<span class="new-window"><svg  height="8px"  style="enable-background:new 0 0 1000 1000;" version="1.1" viewBox="0 0 1000 1000" width="8px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" >
<path d="M598 128h298v298h-86v-152l-418 418-60-60 418-418h-152v-86zM810 810v-298h86v298c0 46-40 86-86 86h-596c-48 0-86-40-86-86v-596c0-46 38-86 86-86h298v86h-298v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:;"/>
</svg>
</span></a>


<a href="https://github.com/LiamElliott-au" target="_blank" class="link-transition github link dib z-999 pt3 pt0-l mr1" title="Github link" rel="noopener" aria-label="follow on Github——Opens in a new window">
  <svg  height="32px"  style="enable-background:new 0 0 512 512;" version="1.1" viewBox="0 0 512 512" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" >
  <path d="M256,32C132.3,32,32,134.8,32,261.7c0,101.5,64.2,187.5,153.2,217.9c11.2,2.1,15.3-5,15.3-11.1   c0-5.5-0.2-19.9-0.3-39.1c-62.3,13.9-75.5-30.8-75.5-30.8c-10.2-26.5-24.9-33.6-24.9-33.6c-20.3-14.3,1.5-14,1.5-14   c22.5,1.6,34.3,23.7,34.3,23.7c20,35.1,52.4,25,65.2,19.1c2-14.8,7.8-25,14.2-30.7c-49.7-5.8-102-25.5-102-113.5   c0-25.1,8.7-45.6,23-61.6c-2.3-5.8-10-29.2,2.2-60.8c0,0,18.8-6.2,61.6,23.5c17.9-5.1,37-7.6,56.1-7.7c19,0.1,38.2,2.6,56.1,7.7   c42.8-29.7,61.5-23.5,61.5-23.5c12.2,31.6,4.5,55,2.2,60.8c14.3,16.1,23,36.6,23,61.6c0,88.2-52.4,107.6-102.3,113.3   c8,7.1,15.2,21.1,15.2,42.5c0,30.7-0.3,55.5-0.3,63c0,6.1,4,13.3,15.4,11C415.9,449.1,480,363.1,480,261.7   C480,134.8,379.7,32,256,32z"/>
</svg>

<span class="new-window"><svg  height="8px"  style="enable-background:new 0 0 1000 1000;" version="1.1" viewBox="0 0 1000 1000" width="8px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" >
<path d="M598 128h298v298h-86v-152l-418 418-60-60 418-418h-152v-86zM810 810v-298h86v298c0 46-40 86-86 86h-596c-48 0-86-40-86-86v-596c0-46 38-86 86-86h298v86h-298v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:;"/>
</svg>
</span></a>







<a href="index.xml" target="_blank" class="link-transition rss link dib z-999 pt3 pt0-l mr1" title="RSS link" rel="noopener" aria-label="RSS——Opens in a new window">
  <svg xmlns="http://www.w3.org/2000/svg" height="32px" width="32px" viewBox="0 0 24 24">
    <circle cx="6.18" cy="17.82" r="2.18"/>
    <path id="scale" d="M4 4.44v2.83c7.03 0 12.73 5.7 12.73 12.73h2.83c0-8.59-6.97-15.56-15.56-15.56zm0 5.66v2.83c3.9 0 7.07 3.17 7.07 7.07h2.83c0-5.47-4.43-9.9-9.9-9.9z"/>
</svg>


<span class="new-window"><svg  height="8px"  style="enable-background:new 0 0 1000 1000;" version="1.1" viewBox="0 0 1000 1000" width="8px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" >
<path d="M598 128h298v298h-86v-152l-418 418-60-60 418-418h-152v-86zM810 810v-298h86v298c0 46-40 86-86 86h-596c-48 0-86-40-86-86v-596c0-46 38-86 86-86h298v86h-298v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:;"/>
</svg>
</span></a>

</div>
  </div>
</footer>

  

  <script src="/dist/js/app.3fc0f988d21662902933.js"></script>


</body>

</html>